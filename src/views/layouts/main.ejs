<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><%= title %></title>

  <!-- Google Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- AdminLTE Theme -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/css/adminlte.min.css">

  <!-- Toastr CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap4.min.css">

  <!-- Select2 CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ttskch/select2-bootstrap4-theme@1.5.2/dist/select2-bootstrap4.min.css">

  <!-- DateTimePicker CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/css/tempusdominus-bootstrap-4.min.css">

  <!-- SweetAlert2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

  <!-- Custom CSS Mínimo -->
  <link rel="stylesheet" href="/css/custom.css">
  <% if(typeof style !== 'undefined'){ %>
    <%- style %>
  <% } %>
  
  <!-- SYNTRA ERP - CSS Essencial (Simplificado) -->
  <style>
    /* === BRAND LOGO === */
    .brand-link {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #28a745 100%);
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .brand-link .brand-text {
      color: rgba(255,255,255,0.95);
      font-weight: 600;
    }
    
    /* === USER PANEL === */
    .user-panel {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      margin: 15px 10px;
      padding: 15px;
    }
    
    .user-panel .info a {
      color: rgba(255,255,255,0.9);
      font-weight: 500;
    }
    
    .user-panel .info small {
      color: rgba(255,255,255,0.7);
      display: block;
      font-size: 11px;
    }
    
    /* === MÓDULOS - CORES IDENTIFICADORAS === */
    .nav-sidebar .nav-item.super-admin-item > .nav-link {
      border-left: 3px solid #e74c3c;
    }
    
    .nav-sidebar .nav-item.admin-item > .nav-link {
      border-left: 3px solid #28a745;
    }
    
    .nav-sidebar .nav-item.vendas-item > .nav-link {
      border-left: 3px solid #ffc107;
    }
    
    .nav-sidebar .nav-item.compras-item > .nav-link {
      border-left: 3px solid #fd7e14;
    }
    
    .nav-sidebar .nav-item.financas-item > .nav-link {
      border-left: 3px solid #dc3545;
    }
    
    .nav-sidebar .nav-item.relatorios-item > .nav-link {
      border-left: 3px solid #6f42c1;
    }
    
    .nav-sidebar .nav-item.config-item > .nav-link {
      border-left: 3px solid #6c757d;
    }
    
    .nav-sidebar .nav-item.core-item > .nav-link {
      border-left: 3px solid #007bff;
    }
    
    /* === SIDEBAR LEGEND === */
    .sidebar-legend {
      background: rgba(255,255,255,0.05);
      margin: 15px 10px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .legend-title {
      color: rgba(255,255,255,0.9);
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 8px;
      text-align: center;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 4px;
      font-size: 10px;
    }
    
    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 3px;
      margin-right: 8px;
      flex-shrink: 0;
    }
    
    .legend-text {
      color: rgba(255,255,255,0.7);
      font-size: 10px;
    }
    
    /* === SIDEBAR COLLAPSED === */
    .sidebar-collapse .sidebar-legend {
      display: none;
    }
  </style>
</head>

<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

  <!-- Navbar compras-->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button">
          <i class="fas fa-bars"></i>
        </a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="/dashboard" class="nav-link">Dashboard</a>
      </li>
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-bell"></i>
          <span class="badge badge-warning navbar-badge">3</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">3 Notificações</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-exclamation-triangle mr-2"></i> Produtos em falta
            <span class="float-right text-muted text-sm">agora</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-file-invoice-dollar mr-2"></i> Vendas do dia
            <span class="float-right text-muted text-sm">2h</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-users mr-2"></i> Novo cliente
            <span class="float-right text-muted text-sm">4h</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">Ver todas as notificações</a>
        </div>
      </li>
      
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-user"></i>
          <% if (user) { %>
            <span class="d-none d-md-inline"><%= user.nome %></span>
          <% } else { %>
            <span class="d-none d-md-inline">Usuário</span>
          <% } %>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <% if (user) { %>
          <div class="dropdown-header">
            <strong><%= user.nome %></strong><br>
            <small class="text-muted"><%= user.email %></small>
          </div>
          <div class="dropdown-divider"></div>
          <a href="/perfil" class="dropdown-item">
            <i class="fas fa-user-cog mr-2"></i> Meu Perfil
          </a>
          <a href="/sistema" class="dropdown-item">
            <i class="fas fa-cog mr-2"></i> Configurações
          </a>
          <div class="dropdown-divider"></div>
          <form action="/auth/logout" method="POST" style="margin: 0;">
            <button type="submit" class="dropdown-item">
              <i class="fas fa-sign-out-alt mr-2"></i> Sair
            </button>
          </form>
          <% } %>
        </div>
      </li>
      
      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Main Sidebar Container -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="/dashboard" class="brand-link">
      <img src="/img/syntra-logo.png" alt="SYNTRA Logo" class="brand-image img-circle elevation-3" style="opacity: .8" onerror="this.style.display='none'">
      <span class="brand-text font-weight-light">SYNTRA ERP</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- User Panel -->
      <% if (user) { %>
      <div class="user-panel mt-3 pb-3 mb-3 d-flex">
        <div class="image">
          <img src="/img/user-default.jpg" class="img-circle elevation-2" alt="User Image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiM2Yzc1N2QiLz4KPHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSI4IiB5PSI4Ij4KPHBhdGggZD0iTTEyIDEyQzE0LjIwOTEgMTIgMTYgMTAuMjA5MSAxNiA4QzE2IDUuNzkwODYgMTQuMjA5MSA0IDEyIDRDOS43OTA4NiA0IDggNS43OTA4NiA4IDhDOCAxMC4yMDkxIDkuNzkwODYgMTIgMTIgMTJaTTEyIDEyQzE0LjIwOTEgMTIgMTYgMTAuMjA5MSAxNiA4QzE2IDUuNzkwODYgMTQuMjA5MSA0IDEyIDRDOS43OTA4NiA0IDggNS43OTA4NiA4IDhDOCAxMC4yMDkxIDkuNzkwODYgMTIgMTIgMTJaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+'">
        </div>
        <div class="info">
          <a href="/perfil" class="d-block"><%= user.nome %></a>
          <small>
            <i class="fas fa-building mr-1"></i>
            Minha Empresa
          </small>
        </div>
      </div>
      <% } %>

      <!-- Sidebar Legend -->
      <div class="sidebar-legend">
        <div class="legend-title">Módulos do Sistema</div>
        <div class="legend-item">
          <div class="legend-color" style="background: #e74c3c;"></div>
          <div class="legend-text">Super Admin</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #28a745;"></div>
          <div class="legend-text">Administrador</div>
        </div>
       
      </div>

      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
          
          <!-- Dashboard -->
          <li class="nav-item core-item">
            <a href="/dashboard" class="nav-link <%= currentPath === '/dashboard' ? 'active' : '' %>">
              <i class="nav-icon fas fa-tachometer-alt"></i>
              <p>Dashboard</p>
            </a>
          </li>

          <!-- ===== MÓDULOS SUPER ADMINISTRADOR ===== -->
          <li class="nav-item <%= currentPath.startsWith('/admin-clientes') ? 'menu-open' : '' %> super-admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/admin-clientes') ? 'active' : '' %>">
              <i class="nav-icon fas fa-building"></i>
              <p>
                Gestão de Clientes/Empresas
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/admin-clientes/clientes/dashboard" class="nav-link <%= currentPath === '/admin-clientes/clientes/dashboard' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Dashboard de Clientes</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin-clientes/clientes/create" class="nav-link <%= currentPath === '/admin-clientes/clientes/create' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Novo Cliente/Empresa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin-clientes/clientes" class="nav-link <%= currentPath === '/admin-clientes/clientes' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Listar Clientes</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin-clientes/modalidades" class="nav-link <%= currentPath === '/admin-clientes/modalidades' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Modalidades de Pagamento</p>
                </a>
              </li>
            </ul>
          </li>

          <li class="nav-item <%= currentPath.startsWith('/plataforma') ? 'menu-open' : '' %> super-admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/plataforma') ? 'active' : '' %>">
              <i class="nav-icon fas fa-server"></i>
              <p>
                Administração da Plataforma
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/plataforma/monitoramento" class="nav-link <%= currentPath === '/plataforma/monitoramento' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Monitoramento do Sistema</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/plataforma/performance" class="nav-link <%= currentPath === '/plataforma/performance' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Performance & Analytics</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/plataforma/configuracoes" class="nav-link <%= currentPath === '/plataforma/configuracoes' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Configurações Globais</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/plataforma/backups" class="nav-link <%= currentPath === '/plataforma/backups' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Backups & Recuperação</p>
                </a>
              </li>
            </ul>
          </li>

          <li class="nav-item <%= currentPath.startsWith('/faturacao') ? 'menu-open' : '' %> super-admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/faturacao') ? 'active' : '' %>">
              <i class="nav-icon fas fa-file-invoice-dollar"></i>
              <p>
                Faturação & Cobrança
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/faturacao/assinaturas" class="nav-link <%= currentPath === '/faturacao/assinaturas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Assinaturas Ativas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/faturacao/faturas" class="nav-link <%= currentPath === '/faturacao/faturas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Faturas Emitidas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/faturacao/pagamentos" class="nav-link <%= currentPath === '/faturacao/pagamentos' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Controlo de Pagamentos</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/faturacao/planos" class="nav-link <%= currentPath === '/faturacao/planos' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Gestão de Planos</p>
                </a>
              </li>
            </ul>
          </li>


          <li class="nav-item <%= currentPath.startsWith('/relatorios-globais') ? 'menu-open' : '' %> super-admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/relatorios-globais') ? 'active' : '' %>">
              <i class="nav-icon fas fa-chart-line"></i>
              <p>
                Relatórios Globais
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/receita-plataforma" class="nav-link <%= currentPath === '/receita-plataforma' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Receita da Plataforma</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/utilizacao" class="nav-link <%= currentPath === '/utilizacao' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Análise de Utilização</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/crescimento" class="nav-link <%= currentPath === '/crescimento' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Crescimento & Métricas</p>
                </a>
              </li>
            </ul>
          </li>

          <!-- ===== MÓDULOS ADMINISTRADOR  ojas/gestao-lojas===== -->
          <li class="nav-item <%= currentPath.startsWith('/pessoas') ? 'menu-open' : '' %> admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/pessoas') ? 'active' : '' %>">
              <i class="nav-icon fas fa-users"></i>
              <p>
                Pessoas
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/pessoas/clientes" class="nav-link <%= currentPath === '/clientes' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Clientes</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/pessoas/fornecedores" class="nav-link <%= currentPath === '/fornecedores' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Fornecedores</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/pessoas/utilizadores" class="nav-link <%= currentPath === '/utilizadores' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Utilizadores</p>
                </a>
              </li>
            </ul>
          </li>

          <li class="nav-item <%= currentPath.startsWith('/artigos') ? 'menu-open' : '' %> admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/artigos') ? 'active' : '' %>">
              <i class="nav-icon fas fa-cube"></i>
              <p>
                Artigos
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/artigos/produtos" class="nav-link <%= currentPath === '/produtos' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Produtos & Serviços</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/artigos/categorias" class="nav-link <%= currentPath === '/categorias' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Categorias</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/artigos/iva" class="nav-link <%= currentPath === '/iva' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Gestão de IVA</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/artigos/codigos-barras" class="nav-link <%= currentPath === '/codigos-barras' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Códigos de Barras</p>
                </a>
              </li>
            </ul>
          </li>

          <li class="nav-item <%= currentPath.startsWith('/lojas') ? 'menu-open' : '' %> admin-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/lojas') ? 'active' : '' %>">
              <i class="nav-icon fas fa-store"></i>
              <p>
                Multi-loja
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/lojas/dashboard-lojas" class="nav-link <%= currentPath === '/dashboard-lojas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Dashboard Multi-loja</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/lojas/gestao-lojas" class="nav-link <%= currentPath === '/gestao-lojas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Gestão de Lojas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/lojas/transferencias-lojas" class="nav-link <%= currentPath === '/transferencias-lojas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Transferências entre Lojas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/lojas/relatorios-consolidados" class="nav-link <%= currentPath === '/relatorios-consolidados' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Relatórios Consolidados</p>
                </a>
              </li>
            </ul>
          </li>

          <!-- ===== MÓDULOS OPERACIONAIS ===== -->
          <!-- Vendas -->
          <li class="nav-item <%= currentPath.startsWith('/vendas') ? 'menu-open' : '' %> vendas-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/vendas') ? 'active' : '' %>">
              <i class="nav-icon fas fa-file-invoice-dollar"></i>
              <p>
                Vendas
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/vendas/facturas" class="nav-link <%= currentPath === '/vendas/facturas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Facturas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/vendas/factura-recibo" class="nav-link <%= currentPath === '/vendas/factura-recibo' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Factura-Recibo</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/vendas/cotacoes" class="nav-link <%= currentPath === '/vendas/cotacoes' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Cotações</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/vendas/vendas-credito" class="nav-link <%= currentPath === '/vendas/vendas-credito' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Vendas a Crédito</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/vendas/relatorios" class="nav-link <%= currentPath === '/vendas/relatorios' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Relatórios de Vendas</p>
                </a>
              </li>
            </ul>
          </li>

          <!-- POS -->
          <li class="nav-item vendas-item">
            <a href="/pos" class="nav-link <%= currentPath === '/pos' ? 'active' : '' %>">
              <i class="nav-icon fas fa-cash-register"></i>
              <p>POS - Ponto de Venda</p>
            </a>
          </li>

          <!-- Compras -->
   
                    <!-- Compras -->
          <li class="nav-item <%= currentPath.startsWith('/compras') ? 'menu-open' : '' %> compras-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/compras') ? 'active' : '' %>">
              <i class="nav-icon fas fa-shopping-cart"></i>
              <p>
                Compras
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/compras" class="nav-link <%= currentPath === '/compras' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Dashboard de Compras</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/compras/mercadoria" class="nav-link <%= currentPath === '/compras/mercadoria' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Compra de Mercadoria</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/compras/mercadoria/create" class="nav-link <%= currentPath === '/compras/mercadoria/create' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Nova Compra de Mercadoria</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/compras/despesas" class="nav-link <%= currentPath === '/compras/despesas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Despesas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/compras/despesas/create" class="nav-link <%= currentPath === '/compras/despesas/create' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Nova Despesa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/compras/relatorios" class="nav-link <%= currentPath === '/compras/relatorios' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Relatórios de Compras</p>
                </a>
              </li>
            </ul>
          </li>

          <!-- Estoque -->
      
                    <!-- Estoque -->
          <li class="nav-item <%= currentPath.startsWith('/estoque') ? 'menu-open' : '' %> compras-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/estoque') ? 'active' : '' %>">
              <i class="nav-icon fas fa-boxes"></i>
              <p>
                Estoque
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/estoque/resumo" class="nav-link <%= currentPath === '/estoque/resumo' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Resumo de Estoque</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/movimentacoes" class="nav-link <%= currentPath === '/estoque/movimentacoes' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Movimentações</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/transferencias" class="nav-link <%= currentPath === '/estoque/transferencias' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Transferências</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/transferencias/create" class="nav-link <%= currentPath === '/estoque/transferencias/create' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Nova Transferência</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/encomendas" class="nav-link <%= currentPath === '/estoque/encomendas' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Notas de Encomenda</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/encomendas/create" class="nav-link <%= currentPath === '/estoque/encomendas/create' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Nova Encomenda</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/guias" class="nav-link <%= currentPath === '/estoque/guias' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Guias de Remessa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/estoque/inventario" class="nav-link <%= currentPath === '/estoque/inventario' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Controlo de Inventário</p>
                </a>
              </li>
            </ul>
          </li>

       
          <li class="nav-item <%= currentPath.startsWith('/financas') ? 'menu-open' : '' %> financas-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/financas') ? 'active' : '' %>">
              <i class="nav-icon fas fa-money-bill-wave"></i>
              <p>
                Finanças
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/financas/dashboard" class="nav-link <%= currentPath === '/financas/dashboard' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Dashboard Financeiro</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/contas-receber" class="nav-link <%= currentPath === '/financas/contas-receber' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Contas a Receber</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/contas-pagar" class="nav-link <%= currentPath === '/financas/contas-pagar' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Contas a Pagar</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/notas-debito" class="nav-link <%= currentPath === '/financas/notas-debito' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Notas de Débito</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/notas-credito" class="nav-link <%= currentPath === '/financas/notas-credito' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Notas de Crédito</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/caixa" class="nav-link <%= currentPath === '/financas/caixa' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Gestão de Caixa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/fluxo-caixa" class="nav-link <%= currentPath === '/financas/fluxo-caixa' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Fluxo de Caixa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/reconciliacao" class="nav-link <%= currentPath === '/financas/reconciliacao' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Reconciliação Bancária</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/financas/bancos" class="nav-link <%= currentPath === '/financas/bancos' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Gestão de Bancos</p>
                </a>
              </li>
            </ul>
          </li>

       
                    <!-- Relatórios -->
          <li class="nav-item <%= currentPath.startsWith('/relatorios') ? 'menu-open' : '' %> relatorios-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/relatorios') ? 'active' : '' %>">
              <i class="nav-icon fas fa-chart-bar"></i>
              <p>
                Relatórios
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/relatorios/vendas-periodo" class="nav-link <%= currentPath === '/relatorios/vendas-periodo' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Vendas por Período</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/vendas-cliente" class="nav-link <%= currentPath === '/relatorios/vendas-cliente' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Vendas por Cliente</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/vendas-artigo" class="nav-link <%= currentPath === '/relatorios/vendas-artigo' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Vendas por Artigo</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/compras-periodo" class="nav-link <%= currentPath === '/relatorios/compras-periodo' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Compras por Período</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/posicao-estoque" class="nav-link <%= currentPath === '/relatorios/posicao-estoque' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Posição de Estoque</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/fluxo-caixa" class="nav-link <%= currentPath === '/relatorios/fluxo-caixa' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Fluxo de Caixa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/relatorios/relatorio-iva" class="nav-link <%= currentPath === '/relatorios/relatorio-iva' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Relatório de IVA</p>
                </a>
              </li>
              
            </ul>
          </li>


          

          <!-- Configurações -->
          <li class="nav-item <%= currentPath.startsWith('/configuracoes') ? 'menu-open' : '' %> config-item">
            <a href="#" class="nav-link <%= currentPath.startsWith('/configuracoes') ? 'active' : '' %>">
              <i class="nav-icon fas fa-cogs"></i>
              <p>
                Configurações
                <i class="fas fa-angle-left right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="/empresa" class="nav-link <%= currentPath === '/empresa' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p>Dados da Empresa</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/sistema" class="nav-link <%= currentPath === '/sistema' ? 'active' : '' %>">
                  <i class="far fa-circle nav-icon"></i>
                  <p> Backup & Recuperação</p>
                </a>
              </li>
              
            </ul>
          </li>

          
          

        </ul>
      </nav>
    </div>
  </aside>

  <!-- Content Wrapper -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
 
    <!-- Content Header (Page header) -->
<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1 class="m-0"><%= title %></h1>
      </div>
      <div class="col-sm-6">
       
                <ol class="breadcrumb float-sm-right">
          <% if (typeof breadcrumbs !== 'undefined' && breadcrumbs && Array.isArray(breadcrumbs) && breadcrumbs.length > 0) { %>
            <% breadcrumbs.forEach(function(breadcrumb, index) { %>
              <% if (index === breadcrumbs.length - 1) { %>
                <li class="breadcrumb-item active"><%= breadcrumb.texto %></li>
              <% } else { %>
                <li class="breadcrumb-item"><a href="<%= breadcrumb.link %>"><%= breadcrumb.texto %></a></li>
              <% } %>
            <% }); %>
          <% } else { %>
            <li class="breadcrumb-item"><a href="/dashboard">Dashboard</a></li>
            <li class="breadcrumb-item active"><%= title %></li>
          <% } %>
        </ol>
      </div>
    </div>
  </div>
</div>

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <% if (typeof error !== 'undefined' && error && error.length > 0) { %>
          <div class="alert alert-danger alert-dismissible">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <h5><i class="icon fas fa-ban"></i> Erro!</h5>
            <%= error %>
          </div>
        <% } %>

        <% if (typeof success !== 'undefined' && success && success.length > 0) { %>
          <div class="alert alert-success alert-dismissible">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <h5><i class="icon fas fa-check"></i> Sucesso!</h5>
            <%= success %>
          </div>
        <% } %>

        <%- body %>
      </div>
    </section>
  </div>

  <!-- Main Footer -->
  <footer class="main-footer">
    <strong>Copyright &copy; <%= new Date().getFullYear() %> <a href="https://syntra.co.mz">SYNTRA ERP</a>.</strong>
    Todos os direitos reservados.
    <div class="float-right d-none d-sm-inline-block">
      <b>Versão</b> 1.0.0
    </div>
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
</div>

<!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>


<!-- Bootstrap 4 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- ChartJS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<!-- Sparkline -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>
<!-- daterangepicker -->
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/locale/pt-br.js"></script>
<script src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.js"></script>


<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap4.min.js"></script>
<!-- Select2 -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/i18n/pt-BR.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
<!-- toastr -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<!-- AdminLTE App -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.2.0/js/adminlte.min.js"></script>

<!-- Configurações Toastr clientes/empres -->
<script>
toastr.options = {
  "closeButton": true,
  "debug": false,
  "newestOnTop": false,
  "progressBar": true,
  "positionClass": "toast-top-right",
  "preventDuplicates": false,
  "onclick": null,
  "showDuration": "300",
  "hideDuration": "1000",
  "timeOut": "5000",
  "extendedTimeOut": "1000",
  "showEasing": "swing",
  "hideEasing": "linear",
  "showMethod": "fadeIn",
  "hideMethod": "fadeOut"
}

// Flash messages
<% if (typeof messages !== 'undefined' && messages.success && messages.success.length > 0) { %>
  <% messages.success.forEach(function(msg) { %>
    toastr.success('<%= msg %>');
  <% }); %>
<% } %>

<% if (typeof messages !== 'undefined' && messages.error && messages.error.length > 0) { %>
  <% messages.error.forEach(function(msg) { %>
    toastr.error('<%= msg %>');
  <% }); %>
<% } %>
</script>

<!-- Script Principal -->
<script>
$(function () {
  'use strict'

  // Configurar moment.js para português
  moment.locale('pt');

  // Função para definir menu ativo baseado no path atual
  function setActiveMenu() {
    var currentPath = window.location.pathname;
    
    // Remover todas as classes ativas primeiro
    $('.nav-sidebar .nav-link').removeClass('active');
    $('.nav-sidebar .nav-item').removeClass('menu-open');
    
    // Procurar por links exatos primeiro
    $('.nav-sidebar .nav-link').each(function() {
      var $link = $(this);
      var href = $link.attr('href');
      
      if (href && href === currentPath) {
        $link.addClass('active');
        
        // Se for um submenu, abrir o menu pai
        var $parentItem = $link.closest('.nav-treeview').closest('.nav-item');
        if ($parentItem.length) {
          $parentItem.addClass('menu-open');
          $parentItem.children('a').addClass('active');
        }
        return false; // Parar o loop quando encontrar
      }
    });
    
    // Se não encontrou link exato, procurar por paths que começam com
    if (!$('.nav-sidebar .nav-link.active').length) {
      $('.nav-sidebar .nav-item').each(function() {
        var $item = $(this);
        var $mainLink = $item.children('a');
        var href = $mainLink.attr('href');
        
        // Verificar se o path atual começa com algum dos caminhos do menu
        if (href && href !== '#' && currentPath.startsWith(href) && href.length > 1) {
          $mainLink.addClass('active');
          $item.addClass('menu-open');
          return false;
        }
      });
    }
  }

  // Inicializar componentes
  setActiveMenu();
  
  // Re-inicializar quando necessário
  $(document).on('click', '.nav-sidebar .nav-link', function() {
    // Pequeno delay para permitir que a navegação aconteça
    setTimeout(setActiveMenu, 100);
  });

  // Log de confirmação
  console.log('✅ SYNTRA ERP - AdminLTE Layout inicializado com sucesso!');
});
</script>

<!-- Scripts específicos da página -->
<% if(typeof script !== 'undefined'){ %>
    <%- script %>
<% } %>

</body>
</html>