


    <!-- Cabeçalho -->
    <div class="d-flex justify-content-between align-items-center mb-4">
     
        
        <div>
            <button class="btn btn-outline-secondary me-2" onclick="window.print()">
                <i class="fas fa-print"></i> Imprimir
            </button>
            <button class="btn btn-success" onclick="exportToExcel()">
                <i class="fas fa-file-excel"></i> Exportar Excel
            </button>
        </div>
    </div>

    <!-- Filtros -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="GET" class="row g-3">
                <div class="col-md-3">
                    <label for="mes" class="form-label">Mês</label>
                    <select class="form-select" id="mes" name="mes">
                        <option value="1" <%= filtros.mes === '1' ? 'selected' : '' %>>Janeiro</option>
                        <option value="2" <%= filtros.mes === '2' ? 'selected' : '' %>>Fevereiro</option>
                        <option value="3" <%= filtros.mes === '3' ? 'selected' : '' %>>Março</option>
                        <option value="4" <%= filtros.mes === '4' ? 'selected' : '' %>>Abril</option>
                        <option value="5" <%= filtros.mes === '5' ? 'selected' : '' %>>Maio</option>
                        <option value="6" <%= filtros.mes === '6' ? 'selected' : '' %>>Junho</option>
                        <option value="7" <%= filtros.mes === '7' ? 'selected' : '' %>>Julho</option>
                        <option value="8" <%= filtros.mes === '8' ? 'selected' : '' %>>Agosto</option>
                        <option value="9" <%= filtros.mes === '9' ? 'selected' : '' %>>Setembro</option>
                        <option value="10" <%= filtros.mes === '10' ? 'selected' : '' %>>Outubro</option>
                        <option value="11" <%= filtros.mes === '11' ? 'selected' : '' %>>Novembro</option>
                        <option value="12" <%= filtros.mes === '12' ? 'selected' : '' %>>Dezembro</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="ano" class="form-label">Ano</label>
                    <select class="form-select" id="ano" name="ano">
                        <option value="2024" <%= filtros.ano === '2024' ? 'selected' : '' %>>2024</option>
                        <option value="2023" <%= filtros.ano === '2023' ? 'selected' : '' %>>2023</option>
                        <option value="2022" <%= filtros.ano === '2022' ? 'selected' : '' %>>2022</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="tipo" class="form-label">Tipo</label>
                    <select class="form-select" id="tipo" name="tipo">
                        <option value="" <%= filtros.tipo === '' ? 'selected' : '' %>>Todos</option>
                        <option value="vendas" <%= filtros.tipo === 'vendas' ? 'selected' : '' %>>Vendas</option>
                        <option value="compras" <%= filtros.tipo === 'compras' ? 'selected' : '' %>>Compras</option>
                    </select>
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary me-2">
                        <i class="fas fa-search"></i> Filtrar
                    </button>
                    <a href="/relatorios/relatorio-iva" class="btn btn-outline-secondary">
                        <i class="fas fa-times"></i> Limpar
                    </a>
                </div>
            </form>
        </div>
    </div>

    <!-- Cards de Resumo -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title">IVA a Pagar</h6>
                            <h3 class="mb-0"><%= resumo.ivaAPagar %></h3>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-arrow-up fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title">IVA a Receber</h6>
                            <h3 class="mb-0"><%= resumo.ivaAReceber %></h3>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-arrow-down fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title">Saldo IVA</h6>
                            <h3 class="mb-0"><%= resumo.saldoIva %></h3>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-balance-scale fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <div>
                            <h6 class="card-title">Total Operações</h6>
                            <h3 class="mb-0"><%= resumo.totalOperacoes %></h3>
                        </div>
                        <div class="align-self-center">
                            <i class="fas fa-file-invoice fa-2x"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabelas de IVA -->
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">IVA das Vendas (a Pagar)</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Taxa IVA</th>
                                    <th>Base Tributável</th>
                                    <th>Valor IVA</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% ivaVendas.forEach(item => { %>
                                <tr>
                                    <td><%= item.taxa %>%</td>
                                    <td><%= item.baseTributavel %></td>
                                    <td><%= item.valorIva %></td>
                                </tr>
                                <% }) %>
                            </tbody>
                            <tfoot class="table-dark">
                                <tr>
                                    <th>Total</th>
                                    <th><%= totalVendas.baseTributavel %></th>
                                    <th><%= totalVendas.valorIva %></th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">IVA das Compras (a Receber)</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Taxa IVA</th>
                                    <th>Base Tributável</th>
                                    <th>Valor IVA</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% ivaCompras.forEach(item => { %>
                                <tr>
                                    <td><%= item.taxa %>%</td>
                                    <td><%= item.baseTributavel %></td>
                                    <td><%= item.valorIva %></td>
                                </tr>
                                <% }) %>
                            </tbody>
                            <tfoot class="table-dark">
                                <tr>
                                    <th>Total</th>
                                    <th><%= totalCompras.baseTributavel %></th>
                                    <th><%= totalCompras.valorIva %></th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Resumo Final -->
    <div class="card mt-4">
        <div class="card-header bg-dark text-white">
            <h5 class="mb-0">Resumo Final do IVA</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <table class="table">
                        <tr>
                            <td><strong>IVA das Vendas (a Pagar):</strong></td>
                            <td class="text-end"><%= totalVendas.valorIva %></td>
                        </tr>
                        <tr>
                            <td><strong>IVA das Compras (a Receber):</strong></td>
                            <td class="text-end">(<%= totalCompras.valorIva %>)</td>
                        </tr>
                        <tr class="table-dark">
                            <td><strong>Saldo de IVA:</strong></td>
                            <td class="text-end"><strong><%= resumo.saldoIva %></strong></td>
                        </tr>
                    </table>
                </div>
                <div class="col-md-6">
                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle"></i> Informações Importantes:</h6>
                        <ul class="mb-0">
                            <li>Prazo de entrega: até ao dia 15 do mês seguinte</li>
                            <li>Declaração mensal obrigatória</li>
                            <li>Verificar documentos de suporte</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function exportToExcel() {
    alert('Funcionalidade de exportação será implementada em breve!');
}
</script>

